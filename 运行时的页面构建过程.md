# 运行时的页面构建过程

---

## 1. 生命周期概览

当用户使用浏览器向服务器发送了请求，服务器接收到请求并处理，然后会向浏览器返回一个由HTML、CSS、JavaScript代码构成的响应。
在浏览器接收到请求时，客户端应用的生命周期就开始了。

客户端应用的生命周期执行步骤如下：

 1. 页面构建——创建用户界面；
 2. 事件处理——进入事件循环等待事件的发生，发生之后调用事件处理器。

## 2. 页面构建阶段
页面构建阶段的目标是建立web应用的UI，主要包括两个步骤：

 1. 解析HTML代码并构建DOM；
 2. 执行JavaScript代码。

 > * 一般而言，JavaScript代码能够在任何程度上修改DOM结构：它能创建新的节点或者是移动现有的DOM节点。但是不能做某些事情，比如选择和修改还没被创建的节点。这也是为什么要把`script`元素放在页面底部的原因。

## 3. 事件处理
浏览器执行环境的核心思想基于：同一时刻只能执行一个代码片段，即所谓的单线程执行模型。
当一个事件抵达后，浏览器需要执行相应的事件处理函数。这里不保证用户总会极富耐心的等待很长时间，直到下一个事件的触发。所以浏览器需要使用事件队列来跟踪已经发生但是尚未处理的事件。

`1.事件处理的过程`：

 1. 浏览器检查事件队列头
 2. 如果浏览器没有在队列中检测到事件，则继续检查
 3. 如果检查到了事件，就取出该事件并执行相应的事件处理器。在这个过程中，剩余的事件在事件队列中耐心的等待，直到轮到它们被处理。
 
`2.注册时间处理器`:

 1. 事件处理器是当某个特定事件发生后期望执行的函数。
 2. 为了执行被期望的函数，我们需要告诉浏览器要处理哪个事件，这个过程称之为注册事件处理器。

    `注册事件的方式`：
    1. 通过把函数赋给某个特殊属性；
    2. 通过使用内置的`addEventListener`方法。

  > * 第一种方式的缺点:对于某个事件只能注册一个事件处理器，如果要注册多个事件处理器，会发生事件处理器覆盖的问题（会被改写）。
  
`3.处理事件`：

 1. 事件处理的主要思想：当事件发生时，浏览器调用相应的事件处理器。
 2. 事件处理阶段，事件循环会检查队列，如果发现队列前面有事件就会执行相应的事件处理器。事件循环会一直执行到用户关闭了web应用。
  
 
 
